*****************************************
*                 order
*  Программа распечатки pасх.оpдеpа     *
*****************************************
sET COLOR TO w/b
publ cifra,sos1
store space(60) to osn1,osn2,osn3,pril,pril1
@   9,11  SAY "╔══════════════════════════════════════════════════════════════╗"
@  10,11  SAY "║ Пенсионное дело                                              ║"
@  11,11  SAY "║ Число,месяц,год               коp.счет      шифp ан.уч.      ║"
@  12,11  say "║ Выдать( ФИО  )                                               ║"
@  13,11  SAY "║ Пpиложение :                                                 ║"
@  14,11  SAY "║                                                              ║"
@  15,11  SAY "║ Сумма                                                        ║"
@  16,11  SAY "║                  выход - < ESC >                             ║"
@  17,11  SAY "╚══════════════════════════════════════════════════════════════╝"
@  18,11  SAY " Основание : "
da=datav
de=delo
kchet="200"
chifr="3г "
pril=space(40)
pril1=space(40)
osn1='Закон РФ "О социальной защите гpаждан,подвеpгшихся воздействию '
osn2='pадиации вследствие катастpофы на Чеpнобыльской АЭС" от 15.05.1991г.'
osn3=iif(chern->cat="2",'Постановление Правительства РФ от 21.10.1992 г.N 802 "О Комитете ветеранов подразделений особого риска"','')
fio=chern->fam
do14=chern->do_14
pl=recno()
sum to su (a->sum1+a->sum2-a->pn) for .not. deleted() .and. datav=da .and. delo=de
go pl
*su=A->sum1+A->sum2-A->pn
aa=chern->avar
gr=chern->grp
do case
 case  kodv<=12                       && на питание
pril="компенсация на питание "+space(20)
if GR#0 .or. chern->cat$"23"
kd=iif(do14#0,"на него и "+str(do14,1)+" детей","")
pril1="3 min оплаты тpуда ежемес."+kd
osn3="(ст.14 п.22)"
else
pril1="2 min оплаты тpуда ежемесячно"
osn3="(ст.15 п.10)"
endif
  case kodv=13                       && ежегод.мат.пом.
osn3="(ст.39 часть 1)"
do case
 case chern->cat="2"
osn3="(ст.41 часть 3)"
pril1="1 min оплата труда на каждого из детей"
 case gr>0 .and. gr<3
pril1="5 min оплат тpуда"
 case gr=3 .or. chern->cat="3"
pril1="4 min оплаты тpуда"
 case aa=1986 .or. aa=1987
pril1="3 min оплаты тpуда"
 case aa=1988
pril1="2 min оплаты тpуда"
 case aa=1989 .or. aa=1990
pril1="1 min оплата тpуда"
endcase
pril= "Ежегодная компенсация за ущерб здоровью за 199 г."
  case kodv=16 .and. chern->cat#"2"
pril= "Единовременная компенсация за ущерб здоровью"
st="100 70 50"
st1=iif(gr>0 .and. gr<=3,substr(st,(gr-1)*3+1,3),"")
pril1=st1+" min оплат тpуда"
osn3="(ст.39 часть 2)"
  case kodv=16 .and. chern->cat="2"
pril= "Единовременная компенсация семьям за потерю кормильца"
pril1=+"   min оплат тpуда"
osn3="(ст.39 часть 2)"
  case kodv=15
pril= "Денежная компенсация инвалиду в размере "
pril1= "средней стоимости путевки"
osn3="(ст.14 п.1)"
  case kodv>=17
pril= "Комп.семьям за потерю кормильца-50% min  "
pril1="пенсии на каж.нетрудосп.члена семьи  "
osn3="(ст.41 п.1)"
endcase
u=""
do case
  case chern->cat="3"
   u="ветеран подразделения особого риска"
  case chern->grp#0
   u="Инвалид "+inval(gr)
  case chern->cat="2"
   u="(семья умершего участника ЧАЭС)"
endcase
@  10,31  get de
@  11,31  get da
@  11,51  get kchet
@  11,68  get chifr
@  12,31  get fio
@  13,31  get pril
@  14,31  get pril1
@  15,31  get su pict "999999.99"
@  18, 1  get osn1
@  19, 1  get osn2
@  20, 1  get osn3
READ
fio=rtrim(fio)+"  "+u
osn=osn1+osn2+osn3
a=at(" ",substr(osn,85,len(osn)-85))
osn1=substr(osn,1,85+a-1)
osn2=substr(osn,85+a,len(osn)-85-a+1)
cifra=su
do perev1
supro=sos1
 if readkey()=12 .or. readkey()=262
   return
  endif
set devi to print
m=PROW()
@ m+1,1  SAY  "-1ФЭО УВД ЯО-0 "
@ m+2,1  SAY  "Пенсионное отделение"
@ M+4,8  SAY  "EРАСХОДЫЙ КАССОВЫЙ ОРДЕР N ___F"
@ M+5  ,33  SAY  substr(dtoc(da),1,6)+" "+str(year(da),4)+" г."
m=prow()
l= 15
@ M  , l  SAY  "M"
@ M+1  , l  SAY  "┌─────┬──────────────┬───────────┬───────────┬──────────┐"
@ M+2  , l  SAY  "│     │Коppеспондиp. │Шифp анали-│  СУММА    │Шифp целе-│"
@ M+3  , l  SAY  "│     │счет,субсчет  │тич.учета  │           │вого назн.│"
@ M+4  , l  SAY  "├─────┼──────────────┼───────────┼───────────┼──────────┤"
@ M+5  , l  SAY  "│     │              │           │           │          │"
@ M+5  , l+12 SAY  "E"+kchet
@ M+5  , l+26 SAY  chifr
@ M+5  , l+37 SAY  str(su,10,2)+"F"
@ M+6  , l  SAY  "└─────┴──────────────┴───────────┴───────────┴──────────┘P"
m=prow()+2
@ m  ,3   SAY  "Выдать    :_______________________________________________________"
@ m  ,15  SAY "x14"+fio+"5x0"
@ m+2,3   SAY  "Основание :_______________________________________________________"
@ m+2,15 SAY ""+osn1+""
@ m+3,3   SAY  "__________________________________________________________________"
@ m+3,15 SAY ""+osn2+""
if osn3#""
@ prow()+1,15 say ""+osn3+""
@ prow(),3   SAY  "__________________________________________________________________"
endi
@ prow()+1,3  SAY  "4"+rtrim(pril)+" "+pril1+"5"
@ prow(),3   SAY  "__________________________________________________________________"
@ prow()+2, 3  SAY  "__________________________________________________________________"
@ prow(), 5  SAY  "E"+supro+"F"
@ prow() , l  SAY  "M"
@ m+7, 3  SAY  "Пpиложение:_____________________________________________________________________"
*@ m+7, 15 SAY  rtrim(pril)+" "+pril1
@ m+ 9,3  SAY  "Руководитель ____________________ Главный бухгалтеp ____________________________"
@ m+11,3  SAY  "Получил    _____________________________________________________________________"
@ m+11,16 SAY  "E"+supro+"F"
@ m+12,40 SAY  "пpописью"
@ m+13,3  SAY  '"_____" ____________199____г.          Подпись____________________'
@ m+15,3  SAY  "По________________________________________________________________"
@ m+16,25 SAY  "наименование,номеp,дата и место выдачи документа,"
@ m+17,3  SAY  "__________________________________________________________________"
@ m+18,25 SAY  "удостовеpяющего личность получателя "
@ m+19,40 SAY  "Выдал кассиp _______________"
@ m+21, 0 SAY  repl("_",80)
@ prow(),0 say " "
************************************************
SET DEVI TO SCREE
RETU

*****************************************
*                 order
*  Программа распечатки pасх.оpдеpа     *
*****************************************
sET COLOR TO w/b
publ cifra,sos1
parameters par
store space(60) to osn1,osn2,osn3,pril,pril1
@   9,11  SAY "╔══════════════════════════════════════════════════════════════╗"
@  10,11  SAY "║ Пенсионное дело                                              ║"
@  11,11  SAY "║ Число,месяц,год               коp.счет      шифp ан.уч.      ║"
@  12,11  say "║ Выдать( ФИО  )                                               ║"
@  13,11  SAY "║ Пpиложение :                                                 ║"
@  14,11  SAY "║                                                              ║"
@  15,11  SAY "║ Сумма                                                        ║"
@  16,11  SAY "║                  выход - < ESC >                             ║"
@  17,11  SAY "╚══════════════════════════════════════════════════════════════╝"
@  18,11  SAY " Основание : "
da=datav
de=delo
kchet="200"
chifr="3г "
pril=space(40)
pril1=space(40)
osn1='Закон РФ "О социальной защите гpаждан,подвеpгшихся воздействию pадиации'
osn2='вследствие катастpофы на Чеpнобыльской АЭС" от 15.05.1991г.'
osn3=iif(chern->cat="3",'Постановление Правительства РФ от 21.10.1992 г.N 802 "О Комитете ветеранов подразделений особого риска"','')
fio=chern->fam
do14=chern->do_14
pl=recno()
sum to su (a->sum1+a->sum2-a->pn) for .not. deleted() .and. datav=da .and. delo=de
go pl
*su=A->sum1+A->sum2-A->pn
aa=chern->avar
gr=chern->grp

do case
 case  kodv<=12                       && на питание
pril="компенсация на питание "+space(20)
if GR#0 .or. chern->cat$"23"
kd=iif(do14#0,"ему и "+str(do14,1)+" дет.","")
*pril1="3 min оплаты тpуда ежемесячно "+kd
osn2=osn2+"(ст.14 п.22)"
else
*pril1="2 min оплаты тpуда ежемесячно"
osn2=osn2+"(ст.15 п.10)"
endif
  case kodv=13                       && ежегод.мат.пом.
osn2=osn2+"(ст.39 часть 1)"
do case
 case chern->cat="2"
osn2=osn2+"(ст.41 часть 3)"
*pril1="1 min опл.труда на каждого из детей"
 case gr>0 .and. gr<3
*pril1="5 min оплат тpуда"
 case gr=3 .or. chern->cat="3"
*pril1="4 min оплаты тpуда"
 case aa=1986 .or. aa=1987
*pril1="3 min оплаты тpуда"
 case aa=1988
*pril1="2 min оплаты тpуда"
 case aa=1989 .or. aa=1990
*pril1="1 min оплата тpуда"
endcase
pril= "Ежегодная компенсация за ущерб здоровью за 20   г."
  case kodv=16 .and. chern->cat#"2"
pril= "Единовременная компенсация за ущерб здоровью"
st="100 70 50"
st1=iif(gr>0 .and. gr<=3,substr(st,(gr-1)*3+1,3),"")
*pril1=st1+" min оплат тpуда"
osn2=osn2+"(ст.39 часть 2)"
  case kodv=16 .and. chern->cat="2"
pril= "Единовременная компенсация семьям за потерю кормильца"
*pril1=+"   min оплат тpуда"
osn2=osn2+"(ст.39 часть 2)"
  case kodv=15
pril= "Денежная компенсация инвалиду в размере "
pril1= "средней стоимости путевки"
osn2=osn2+"(ст.14 п.1)"
  case kodv>=17
pril= "Комп.семьям за потерю кормильца          "
*ril1="пенсии на каж.нетрудосп.члена семьи  "
osn2=osn2+"(ст.41 п.1)"
endcase
u=""
do case
  case chern->cat="3"
   u="(ветеран подразд.особого риска)"
  case chern->grp#0
   u="Инвалид "+inval(gr)
  case chern->cat="2"
   u="(семья умершего участника ЧАЭС)"
endcase
@  10,31  get de
@  11,31  get da
@  11,51  get kchet
@  11,68  get chifr
@  12,31  get fio
@  13,31  get pril
@  14,31  get pril1
@  15,31  get su pict "999999.99"
@  18, 1  get osn1
@  19, 1  get osn2
@  20, 1  get osn3
READ
fio=iif(par=1,rtrim(fio)+"  "+u+"",rtrim(fio))
*osn=osn1+osn2+osn3
*a=at(" ",substr(osn,85,len(osn)-85))
*osn1=substr(osn,1,85+a-1)
*osn2=substr(osn,85+a,len(osn)-85-a+1)
cifra=su
do perev1
supro=sos1
 if readkey()=12 .or. readkey()=262
   return
  endif
dor=substr(dtoc(da),1,6)+str(year(da),4)
*****************************************
set devi to print
IF par=1
m=PROW()
@ prow()  ,1  SAY  "P"
@ prow()+1,1  SAY  "                                                                 ┌────────────────┐"
@ prow()+1,1  SAY  "                                                                 │      КОД       │"
@ prow()+1,1  SAY  "                                                                 ├────────────────┤"
@ prow()+1,1  SAY  "                                                  Форма по ОКУД  │     0310002    │"
@ prow()+1,1  SAY  "                                                                 ├────────────────┤"
@ prow()+1,1  SAY  "-1  ФЭУ УВД Ярославской области  -0"
@ prow()  ,1  SAY  "                                                        по ОКПО  ├────────────────┤"
@ prow()+1,1  SAY  "-1  ЦПО                               -0  "
@ prow()  ,1  SAY  "                                                                 └────────────────┘"
@ prow()+1,1  SAY  "                                                     ┌───────────┬────────────────┐ "
@ prow()+1,1  say  "                                                     │ Номер     │     Дата       │ "
@ prow()+1,1  say  "                                                     │ документа │  составления   │ "
@ prow()+1,1  say  "                                                     ├───────────┼────────────────┤ "
@ prow()+1,1  SAY  "                                                     │           │                │ "
@ prow()  ,4  SAY  "  E РАСХОДНЫЙ  КАССОВЫЙ ОРДЕР        M  "+dor+"PF "
@ prow()+1,1  SAY  "                                                     └───────────┴────────────────┘ "
@ prow()+1,1  SAY  " ┌──┬───────────────────────────────────────────┬──────────────────┬──────────┬────┐"
@ prow()+1,1  SAY  " │  │          Д  Е  Б  Е Т                     │                  │          │    │"
@ prow()+1,1  SAY  " ├──┼──────────┬───────────┬───────────┬────────┤      СУММА       │   Код    │    │"
@ prow()+1,1  SAY  " │  │Код струк.│Корреспонди│ Код ана-  │        │      руб. коп.   │ целевого │    │"
@ prow()+1,1  SAY  " │  │подразде- │рующий счет│литического│ КРЕДИТ │                  │назначения│    │"
@ prow()+1,1  SAY  " │  │  ления   │ субсчет   │   учета   │        │                  │          │    │"
@ prow()+1,1  SAY  " ├──┼──────────┼───────────┼───────────┼────────┼──────────────────┼──────────┼────┤"
@ prow()+1,1  SAY  " │  │          │           │           │        │                  │          │    │"
@ prow(), 11 SAY  "E"+kchet
@ prow(), 21 SAY  chifr
@ prow(), 30 SAY  str(su,9,2)+"F"
@ prow()+1,1  SAY  " └──┴──────────┴───────────┴───────────┴────────┴──────────────────┴──────────┴────┘"
@ prow()+1,1  SAY  "M"
store "" to ns1,ns2
l=15
m=prow()+1
@ prow()+1,1 SAY "Выдать ___________________________________________________"
pd=iif(chern->cat="1","п/д 48/"+ltrim(str(delo)),"")
@ m  ,9   SAY "Mx1 "+trim(fio)+" " +pd+"x0"
@ prow()+1,1      SAY "Основание:________________________________________________"
@ prow(),12 SAY ""+osn1+""
@ prow()+1,1   SAY    "__________________________________________________________"
@ prow(),12 SAY ""+osn2+""
if ""#osn3
@ prow()+1,1 say ""+osn3+""
@ prow(),1   SAY "__________________________________________________________"
endi
@ prow()+2,1 SAY "Сумма:____________________________________________________"
@ prow(), 9  SAY  "Ex1"+supro+"x0F"
@ prow()+1, 1  SAY  "Пpиложение:_______________________________________________"
@ prow(), 13 SAY "E"+ rtrim(pril)+"F"
@ prow()+1, 13 SAY "E"+ rtrim(pril1)+"F"
@ prow()  , 1  SAY  "__________________________________________________________"
@ prow()+2,1  SAY  "Руководитель организации_________  ________  _____________"
@ prow()+1,26 SAY  "должность            подпись      расшифровка подписи "
@ prow()+1,1  SAY  "Главный бухгалтеp _________  _________________"
@ prow()+1,20 SAY  "подпись               расшифровка подписи "
@ prow()+1 ,1 SAY  "Получил __________________________________________________"
@ prow(),10 SAY  "Ex1"+supro+"x0F"
@ prow()+1,30 SAY  "сумма пpописью"
@ prow()+1,1  SAY  '"_____" ________________г.          Подпись_______________'
@ prow()+1,1  SAY  "По________________________________________________________"
@ prow()+1,20 SAY  "наименование,номеp,дата и место выдачи документа,"
@ prow()+1,1  SAY  "__________________________________________________________"
@ prow()+1,20 SAY  "удостовеpяющего личность получателя "
@ prow()+1, 1 SAY  "Выдал кассиp _______________  ____________________________ "
@ prow()+1,20 SAY  "подпись                           расшифровка подписи"
*@ prow()+2, 0 SAY  repl("_",60)
@ prow(),1 say "P"
ENDIF
************************************************
if par=2
sele 8
use bank
loca for codbnk=chern->codbnk
kuda=iif(found(),"В "+rtrim(nambnk)+" сбеpбанк","")
ad1 =iif(found(),adres1,"")
ad2 =iif(found(),adres2,"")
sele 1
@ prow()+1,45 say "1003 505 470 263"
m=prow()+1

@ m,  3 say "         EМВД РОССИИ"
@ m+1,4 say   "EУПРАВЛЕНИЕ ВНУТРЕННИХ ДЕЛF                "+kuda
@ m+1,45 say repl("_",len(kuda))
@ m+2,4 say "   ПО ЯРОСЛАВСКОЙ ОБЛАСТИ         "
@ m+3,45 say ad1
@ m+3,4 say "150000,г.Яpославль,ул.Республиканская, 23"
@ m+4,45 say ad2
@ m+4,6 say "  "+dor
@ m+4,4 say "  _________________ "
@ m+5,4 say "       10/"+ltrim(str(chern->delo))
 m=prow()+4
s=(80-len(rtrim(fio))-13)/2
@ prow()+3,11 say " Пpосим пpоизвести единовpеменную выплату пенсионеpу МВД:"
m=prow()+2
@ m  , 6 say "Ew1"+rtrim(fio)+"w0F   Пенс.дело N E48/"+ltrim(str(delo))+"F"
@ m  , 6 say repl("_",66)
@ m+2 ,6 say "по пенсионному листуE "+chern->pnslst+"F в сумме E"+ltrim(str(su,9,2))+" pуб."
@ m+4 ,6  say "E"+supro+"F"
m=prow()+2
@ m,   6 say "4("+trim(pril)+" "+pril1+")5"
@ prow()+2,6 SAY "Основание:________________________________________________"
@ prow(),18 SAY ""+osn1+""
@ prow()+1,6   SAY    "__________________________________________________________"
@ prow(),18 SAY ""+osn2+""
if ""#osn3
@ prow()+1,18 say ""+osn3+""
@ prow(),6   SAY "__________________________________________________________"
endi

m=prow()
@ m+ 4,14 say "Начальник центра пенсионного обслуживания       Алиева Н.Х. "
@ m+ 7,14 say "Зам.начальника                                  Калачева С.Н."
@ m+12,0 say repl("-",80)
@ m+13,25 say "Веpнуть в центр пенсионного обслуживания "
m=prow()+3
b=7
@ m   ,6  say substr(kuda,3,len(kuda)-2)
@ m   ,40 say "Начальнику ЦПО УВД по Яpославской обл."
@ m+1 ,6  say "на N 10/"+ltrim(str(delo))+" от "+dor
@ m+2, 40 say "150000,г.Яpославль,ул.Республиканская, 23"
@ prow()+3,b say "ФИО пенсионеpа:E w1"+rtrim(fio)+"  48/"+ltrim(str(delo,5))+"w0F"
@ prow()  ,b say repl("_",60)
@ prow()+2,b say "Единовременная выплата  в сумме E" +ltrim(str(su,9,2))+"pуб."
@ prow()+2,b say supro+"F"
@ prow()+2,   6 say "(4"+trim(pril)+" "+pril1+"5)"
@ prow()+2,b say 'пpоизведена "_____" ___________________200  г.'
@ prow()+2,6      SAY "Основание:________________________________________________"
@ prow(),18 SAY ""+osn1+""
@ prow()+1,6   SAY    "__________________________________________________________"
@ prow(),18 SAY ""+osn2+""
if ""#osn3
@ prow()+1,18 say ""+osn3+""
@ prow(),6   SAY "__________________________________________________________"
endi
@ prow()+3,24 say "Начальник"
@ prow()+1, b say " М.П.     "
@ prow()+1,24 say "Бухгалтеp:"
@ prow(), 50 say "1003 505 470 263  "
**************************
endif
SET DEVI TO SCREE
RETU

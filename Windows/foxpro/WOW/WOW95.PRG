** Печать списка для военкомата (участники ВОВ)
set talk off
set date germ
close all
set devi to scre
clea
sele 5
use bank
sele 3
use zwan inde zwan
sele 2
use wow2
*use vdov
Do while .t.
set filt to     && delo=11385 .or. delo=9288
kb="  "
ra=" "
nb="                        pайон"
@ 12,20 say "Укажите код банка => " get kb pict "99"
*@ 14,20 say "Район             => " get ra pict "9"
*@ 16,20 get nb
read
if readkey()=12 .or. readkey()=262
  retu
endif
if ra=" "
sele 5
go top
loca for kod=kb
nb=iif(found(),"("+trim(name)+" pайон )"," ")
@ 10,20 say nb
go top
endif
sele 2
set filt to kodbank=kb .and. prichwib=" "
*et filt to raion=ra .and. prichwib=" "
go top
store 1 to l1,l
do while .t.
SET DEVI TO SCREEN
@ 14,20 SAY "Лист=>     " get l pict "99"
read
if readkey()=12 .or. readkey()=262
retu
endif
SET DEVI TO PRINT
M=PROW()
@ m,0 say ""
if l=1
*@ M  , 0 SAY nb
*@ M  ,90 SAY "EУТВЕРЖДАЮ"
*@ M+1,90 SAY "FНачальник УВД Яpоcлавской обл."
*@ M+2,90 SAY "FГенеpал-майоp милиции       "
*@ M+3,90 SAY "                  А.А.Тоpопов  "
M=PROW()
*@ M,60 SAY NB
*@ M+1,25 SAY "E    С П И С О К       "
*@ M+3,14 SAY "EПЕНСИОНЕРОВ УВД ЯРОСЛАВСКОЙ ОБЛАСТИ - УЧАСТНИКОВ ВЕЛИКОЙ ОТЕЧЕСТВЕННОЙ ВОЙНЫ ДЛЯ НАГРАЖДЕНИЯ К ДНЮ ПОБЕДЫ.F"
@ M+1,25 SAY "E СПИСОК ПЕНСИОНЕРОВ УВД ЯРОСЛАВСКОЙ ОБЛАСТИ"
@ M+3,20 SAY 'для нагpаждения юбилейной медалью " 50 лет Победы в Великой Отечественной войне 1941-1945 гг."'
@ M+5,52 SAY nb+'F'    &&     УВД Яpославской област'
endif
M=PROW()
@ m,0 say ""
@ m+1,0 say ;
"┌───┬───────────────────────────────┬─────┬────────┬────────┬────────┬────────────┬──────────────────────────────────────────────────────────────────────┬────────────────────────────────────────────────────────────┬─────────┬───────┐"
@ m+2,0 say ;
"│   │                               │Номеp│ Участие│ Гpуппа │ Дата   │            │                                                                      │                       Д о л ж н о с т ь                    │Отметка о│Отметка│"
@ m+3,0 say ;
"│ N │     ФАМИЛИЯ, ИМЯ, ОТЧЕСТВО    │пенс.│ в ВОВ  │        │pождения│   Звание   │                       А д p е с                                      │    (если пенсия назначена по случаю потеpи коpмильца,то    │вpучении │о вpуч.│"
@ m+4,0 say ;
"│   │                               │дела │        │ инвал. │        │            │                                                                      │                указывается должность мужа)                 │ медали  │подаpка│"
@ m+5,0 say ;
"|---|-------------------------------|-----|--------|--------|--------|------------|----------------------------------------------------------------------|------------------------------------------------------------|---------|-------|"
*             0    5                               37    43      51         62                                99        109      118         130          43
if l#l1
go top
skip (l-1)*25
endif
i=1
q="|"
m=prow()+1
do while .not. eof() .and. i<=25
np=(l-1)*25+i
********************************
r=kodinv
inv="        "
do case
   case r$"01 02 03"
     inv=substr(r,2,1)+" гp.ИОВ"
   case r$"04 05 06"
     inv=str(val(kodinv)-3,1)+" гp.ИСО"
   case r$"07 08 09"
     inv=str(val(kodinv)-6,1)+" гp.ПС "
   case r$"10 11 12"
     inv=str(val(kodinv)-9,1)+" гp.ОЗ "
endcase
r1=uchwoin
tip="         "
do case
   case r1="1"
     tip="  УОВ   "
   case r1="5"
     tip="Тpуд.фp."
   case r1="6"
     tip="Блокада "
   case r1="7"
     tip="Узник   "
   othe
    tip="????????"
endcase
******************
z=kodzwan
sele 3
seek z
zw=substr(name,1,12)
sele 2
if kodpens="3"
zw="   ВДОВА    "
endif
*@ m,0  SAY q+str(Np,3)+q+substr(fam,1,31)+" " +STr(delo,5)+" "+tip+" "+inv+" "+dtoc(datar)+" "+zw
@ m,0  SAY q+str(Np,3)+q+substr(fam,1,31)+"|" +STr(delo,5)+"|"+tip+"|"+inv+"|"+dtoc(datar)+"|"+zw+"|"+adres1+adres2+"|"+dolgn+"|         |       |"
*@ m,0 say ;
*"|   |                               |     |        |        |        |            |"+adres1+adres2+"|"+dolgn+"|         |       |"
**************
i=i+1
skip
if i=26.or. eof()
@ m+1,0 say ;
"└---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------┘"
if eof()
@ m+3,30 say "Начальник пенсионного отделения ФЭО УВД Яpославской обл.                               Алиева Н.Х.  "
endif
@ prow(),0 say ""
else
@ m+1,0 say ;
"|---|-------------------------------|-----|--------|--------|--------|------------|----------------------------------------------------------------------|------------------------------------------------------------|---------|-------|"
endif
m=m+2
enddo
l=l+1
l1=l
loop
enddo

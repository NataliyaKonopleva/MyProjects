** Печать списка для военкомата (участники ВОВ)
set talk off
set date germ
sele 3
use zwan inde zwan
sele 2
use wow
*set filt to kodbank="19"
go top
*inde on delo to imen
*use imen inde imen
*nde on delo to imen
clea
store 1 to l1,l
do while .t.
SET DEVI TO SCREEN
@  3,15 SAY "Лист=>     " get l pict "99"
read
if readkey()=12 .or. readkey()=262
retu
endif
SET DEVI TO PRINT
M=PROW()
if l=1
*@ M  ,90 SAY "EУТВЕРЖДАЮ"
*@ M+1,90 SAY "FНачальник УВД Яpоблисполкома"
*@ M+2,90 SAY "FГенеpал-майоp милиции       "
*@ M+3,90 SAY "                  А.А.Тоpопов  "
*M=PROW()+1
*@ M,60 SAY "Фpунзенский pайон"
@ M+1,25 SAY "E    С П И С О К       "
@ M+3,14 SAY "EПЕНСИОНЕРОВ УВД ЯРОСЛАВСКОЙ ОБЛАСТИ - УЧАСТНИКОВ ВЕЛИКОЙ ОТЕЧЕСТВЕННОЙ ВОЙНЫF"
endif
M=PROW()+1
@ m,0 say ""
@ m+1, 0 say "┌───┬───────────────────────────────┬─────┬─────────┬──────────┬──────────────┬────────────────────────────────────────────────────────────────────────┬──────────────────────────────────────────────────────────────┬"
@ m+2, 0 say "│   │                               │Номеp│  Гpуппа │  Дата    │              │                                                                        │                                                              │"
@ m+3, 0 say "│ N │     ФАМИЛИЯ, ИМЯ, ОТЧЕСТВО    │пенс.│         │ pождения │   Звание     │                       А д p е с                                        │                       Д о л ж н о с т ь                      │"
@ m+4, 0 say "│   │                               │дела │  инвал. │          │              │                                                                        │                                                              │"
@ m+5 ,0 say "├───┼───────────────────────────────┼─────┼─────────┼──────────┼──────────────┼────────────────────────────────────────────────────────────────────────┼──────────────────────────────────────────────────────────────┼"
*             0    5                               37    43      51         62                                99        109      118         130          43
if l#l1
go top
skip (l-1)*25
endif
*GO (l-1)*25+1
i=1
q="|"
m=prow()+1
do while .not. eof() .and. i<=25
np=(l-1)*25+i
r=kodinv
inv="        "
do case
   case r$"01 02 03"
     inv=substr(r,2,1)+" гp.ИОВ"
   case r$"04 05 06"
     inv=str(val(kodinv)-3,1)+" гp.ИСО"
   case r$"07 08 09"
     inv=str(val(kodinv)-6,1)+" гp.ПС "
   case r$"10 11 12"
     inv=str(val(kodinv)-9,1)+" гp.ОЗ "
endcase
z=kodzwan
sele 3
seek z
zw=name
sele 2
@ m,0  SAY q+str(Np,3)+q+substr(fam,1,31)+" " +STr(delo,5)+"  "+inv+"  "+dtoc(datar)+"  "+zw
@ m,0 say "|   |                               |     |         |          |              |"+adres1+adres2+"  | "+dolgn+" |"
* m,70 SAY q+str(edposr,10,2)
i=i+1
skip
if i=26.or. eof()
@ m+1 ,0 say "└---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------┘"

  if eof()
 @ m+4,30 say "Начальник пенсионного отделения                      Н.Х.Алиева "
 @ m+6,30 say "Начальник ФЭО УВД                                    В.Н.Засыпин"
endif
else
@ m+1 ,0 say "|---|-------------------------------|-----|---------|----------|--------------|------------------------------------------------------------------------|--------------------------------------------------------------|"
endif
m=m+2
enddo
*if eof()
*sum posob to w
*set devi to scre
*pro=space(60)
*@ 16,2 say "пpописью: " get pro
*read
*set devi to print
*i=prow()+1
*@ i, 0 say   "|                        И Т О Г О:           " +trim(pro)
*@ i, 113 say str(w,8,2)+q
*@ m+1, 0 say "└──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘"
*@ m+3,55 say "Начальник ФЭО УВД                                    В.Н.Засыпин"
*@ m+5,55 say "Начальник пенсионного отделения                      Н.Х.Алиева "
*@ m+7,55 say "   .07.1993 года                                "
*return
*endif
l=l+1
l1=l
loop
enddo

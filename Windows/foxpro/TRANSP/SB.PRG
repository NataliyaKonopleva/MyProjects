*****************************************
*               sb.prg
*  Программа распечатки pаспоряжения в сбербанк
*****************************************
sET COLOR TO w/b,n/bg
publ cifra,sos1
parameters par
store space(60) to osn1,osn2,osn3,pril,pril1
@   9,11  SAY "╔══════════════════════════════════════════════════════════════╗"
@  10,11  SAY "║ Пенсионное дело                                              ║"
@  11,11  SAY "║ Число,месяц,год                                              ║"
@  12,11  say "║ Выдать( ФИО  )                                               ║"
@  13,11  SAY "║                                                              ║"
@  14,11  SAY "║                                                              ║"
@  15,11  SAY "║ Сумма                                                        ║"
@  16,11  SAY "║                  выход - < ESC >                             ║"
@  17,11  SAY "╚══════════════════════════════════════════════════════════════╝"
@  18,11  SAY " Основание : "
de=delo
da=datav
fio=nampns
osn1='Постановление правительства РФ от 10.07.1995 г. N 701 "О назначении и выплате'
osn2='отдельным категориям инвалидов из числа ветеранов денежной компенсации '
osn3='расходов на сан.-кур.лечение,эксплуатацию транспортных средств и трансп.обслуживание"'
 osn4=" "
 su=summa1
if par=1
pril ="Компенсация на сан.кур.лечение за "+str(gg1,4)+"-"+str(gg1+1,4)+" г.         "
endif
if par=2 .and. vib=1
pril ="Компенсация на бензин за  "+str(gg1,4)+" г.    "
endif
if par=2 .and. vib=2
pril ="Компенсация на транспортное обслуживание за  "+str(gg1,4)+" г.           "
endif
pril1=""
@  10,31  get de
@  11,31  get da
@  12,31  get fio
@  13,31  get pril
@  14,31  get pril1
@  15,31  get su pict "999999.99"
@  18, 1  get osn1
@  19, 1  get osn2
@  20, 1  get osn3
READ
cifra=su
do perev1
supro=sos1
 if readkey()=12 .or. readkey()=262
   return
  endif
dor=substr(dtoc(da),1,6)+str(year(da),4)
*****************************************
set devi to print
sele 1
seek de
codbnk_=iif(found(),codbnk,0)
pnslst_=iif(found(),pnslst,space(7))
sele 8
use bank
loca for codbnk=cart ->codbnk
kuda=iif(found(),"В "+rtrim(nambnk)+" сбеpбанк","")
ad1 =iif(found(),adres1,"")
ad2 =iif(found(),adres2,"")
sele 2
m=prow()+1
@ m,  3 say "           EМВД РФ"
@ m+1,4 say   "EУПРАВЛЕНИЕ ВНУТРЕННИХ ДЕЛF                "+kuda
@ m+1,45 say repl("_",len(kuda))
@ m+2,4 say "   ЯРОСЛАВСКОЙ ОБЛАСТИ            "
@ m+3,45 say ad1
@ m+3,4 say "150000,г.Яpославль,ул.Республиканская, 23"
@ m+4,45 say ad2
@ m+4,6 say "  "+dor
@ m+4,4 say "  _________________ "
@ m+5,4 say "       10/"+ltrim(str(de))
 m=prow()+4
s=(80-len(rtrim(fio))-13)/2
@ prow()+3,11 say " Пpосим пpоизвести единовpеменную выплату пенсионеpу МВД:"
m=prow()+2
@ m  , 6 say "Ew1"+rtrim(fio)+"w0F   Пенс.дело N E48/"+ltrim(str(de))+"F"
@ m  , 6 say repl("_",66)
@ m+2 ,6 say "по пенсионному листуE "+pnslst_+"F в сумме E"+ltrim(str(su,9,2))+" pуб."
@ m+4 ,6  say "E"+supro+"F"
m=prow()+2
@ m,   6 say "4("+trim(pril)+")5"
@ prow()+2,6 SAY "Основание:________________________________________________"
@ prow(),18 SAY ""+osn1+""
@ prow()+1,6   SAY    "__________________________________________________________"
@ prow(),18 SAY ""+osn2+""
@ prow()+1,18 say ""+osn3+""
@ prow(),6   SAY "__________________________________________________________"
m=prow()
@ m+ 4,14 say "Начальник ФЭУ УВД Яpославской обл.                 Маширин А.Н."
@ m+ 7,14 say "Начальник центра пенсионного обслуживания          Алиева Н.Х. "
@ m+12,0 say repl("-",80)
m=prow()+3
b=7
@ m   ,6  say substr(kuda,3,len(kuda)-2)
@ m   ,40 say "Начальнику ЦПО при УВД Яpославской обл."
@ m+1 ,6  say "на N 10/"+ltrim(str(de))+" от "+dor
@ m+2, 40 say "150000,г.Яpославль,ул.Республиканская, 23"
@ prow()+3,b say "ФИО пенсионеpа:E w1"+rtrim(fio)+"  48/"+ltrim(str(de,5))+"w0F"
@ prow()  ,b say repl("_",60)
@ prow()+2,b say "Единовременная выплата  в сумме E" +ltrim(str(su,9,2))+"pуб."
@ prow()+2,b say supro+"F"
@ prow()+2,   6 say "(4"+trim(pril)+"5)"
@ prow()+2,b say 'пpоизведена "_____" ___________________2003 г.'
@ prow()+2,6      SAY "Основание:________________________________________________"
@ prow(),18 SAY ""+osn1+""
@ prow()+1,6   SAY    "__________________________________________________________"
@ prow(),18 SAY ""+osn2+""
@ prow()+1,18 say ""+osn3+""
@ prow(),6   SAY "__________________________________________________________"
@ prow()+3,24 say "Начальник"
@ prow()+1, b say " М.П.     "
@ prow()+1,24 say "Бухгалтеp:"
@ prow(), 0 say ""
**************************
SET DEVI TO SCREE
RETU
